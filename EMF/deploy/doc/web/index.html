<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Emissions Modeling Framework Installation Instructions</title>
<link rel="stylesheet" type="text/css" href="css/style.css" />
<style type="text/css">
li {
  padding-bottom: 15px;
}
</style>
</head>

<body>
<div id="border">  
  <div id="container">
    <div id="header">
      <p>Emissions Modeling Framework</p>
    </div>
    <div id="content">
      <h2>Installation instructions for EPA users</h2>
      
      <p>Instructions last updated 3/25/2019</p>
      
      <h3>EMF client installation on Windows</h3>
      <ol>
      <li><p style="margin-bottom: 10px">The EMF client requires Java 8 or higher to run. If you're not sure if Java is installed on your computer or what version you have, follow <a href="https://www.java.com/en/download/help/version_manual.xml#jcpl" target="_blank">these instructions</a> to locate the Java Control Panel.</p>
      <p style="margin-bottom: 0">If you need to install Java, download it from <a href="https://java.com/en/download/windows_offline.jsp" target="_blank">https://java.com/en/download/windows_offline.jsp</a> and follow the instructions in the installer program. You will need Administrator privileges to install Java.</p></li>

      <li>Download and save the EMF installation package <a href="emfinst.zip">emfinst.zip</a>.</li>

      <li>In Windows Explorer, navigate to your downloads directory. Right-click emfinst.zip, select Extract All..., and then click the <strong>Extract</strong> button.</li>

      <li style="padding-bottom: 0">
      <p style="margin-bottom: 10px">If your user account has Administrator privileges, double-click on emfinst.exe inside the archive. Otherwise, right-click on emfinst.exe and select "Run as administrator".</p>
      <p style="margin-bottom: 10px">You can install the EMF client as a non-administrator user. In the steps below, make sure to choose file locations in your user directory (i.e. C:\Users\username). Also, the final step of the installer tries to create a shortcut in the Start Menu. You'll see an error message "Installation failed", but the EMF client will have installed successfully.</p>

      <ul style="margin-bottom: 0">
      <li>When you run emfinst.exe, you may see a security warning because the publisher could not be verified. Click <strong>Run</strong> to continue.</li>
      
      <li>First, the EMF Client Installer Extractor will run. On the introduction screen, click <strong>Next</strong>.</li>
      
      <li>You will need to set the directory where the EMF installer will be extracted. The default location is C:\Program Files\EMF Client Installer. If you are not an administrator or don't want to put the installer in Program Files, you can choose a location in your home directory like C:\Users\username\EMF Client Installer.</li>
      
      <li>Click <strong>Next</strong> to extract the installer. Once complete, the EMF installer program will start automatically.</li>
      </ul>
      </li>

      <li>When the EMF Client Installer launches, you will see a window with various directory locations and settings. You will need to set values for the <strong>Client Home Directory</strong> and the <strong>Local Temp Directory</strong>. Each field is described below.
      <table style="padding-top: 10px; font-size: 13px">
        <tr>
          <th>Field Name</th>
          <th style="text-align: left">Description and Field Value</th>
        </tr>
        <tr>
          <td style="white-space: nowrap; vertical-align: top; padding-right: 10px">
            EMF Download URL
          </td>
          <td style="padding-bottom: 10px">
            URL for downloading and updating EMF client software; do not change<br>
            <code>https://www.cmascenter.org/emf/install/</code>
          </td>
        </tr>
        <tr>
          <td style="white-space: nowrap; vertical-align: top; padding-right: 10px">
            Server Import Directory
          </td>
          <td style="padding-bottom: 10px">
            EMF server-side data file import directory; this directory is on the EPA EMF server<br>
            <code>/oaqps/share/import</code>
          </td>
        </tr>
        <tr>
          <td style="white-space: nowrap; vertical-align: top; padding-right: 10px">
            Server Export Directory
          </td>
          <td style="padding-bottom: 10px">
            EMF server-side data file export directory; this directory is on the EPA EMF server<br>
            <code>/oaqps/share/export</code>
          </td>
        </tr>
        <tr>
          <td style="white-space: nowrap; vertical-align: top; padding-right: 10px">
            Java Home Directory
          </td>
          <td style="padding-bottom: 10px">
            Java Runtime Environment (JRE) install home directory; automatically set based on where Java is installed on your computer<br>
            <code>C:\Program Files\Java\jre1.8.0_51</code>
          </td>
        </tr>
        <tr>
          <td style="white-space: nowrap; vertical-align: top; padding-right: 10px">
            R Bin Directory
          </td>
          <td style="padding-bottom: 10px">
            R bin directory; R is not required but can be used to create plots<br>
            <code>C:\Program Files\R\rw2000\bin</code>
          </td>
        </tr>
        <tr>
          <td style="white-space: nowrap; vertical-align: top; padding-right: 10px">
            Client Home Directory
          </td>
          <td style="padding-bottom: 10px">
            Directory where the EMF client software will be installed; example locations shown below<br>
            <code>C:\Program Files\EMF Client</code><br>
            <code>C:\Users\username\EMF Client</code>
          </td>
        </tr>
        <tr>
          <td style="white-space: nowrap; vertical-align: top; padding-right: 10px">
            Local Temp Directory
          </td>
          <td style="padding-bottom: 10px">
            Directory for locally downloaded files<br>
            <code>C:\Users\username\AppData\Local\Temp</code>
          </td>
        </tr>
        <tr>
          <td style="white-space: nowrap; vertical-align: top; padding-right: 10px">
            Server Address
          </td>
          <td style="padding-bottom: 10px">
            EMF service site URL; do not change<br>
            <code>http://sage.nesc.epa.gov:8080/emf/services</code>
          </td>
        </tr>
        <tr>
          <td style="white-space: nowrap; vertical-align: top; padding-right: 10px">
            Output Preferences File
          </td>
          <td style="padding-bottom: 10px">
            Automatically created file where EMF preferences are stored; not editable<br>
            <code>C:\Users\username\EMFPrefs.txt</code>
          </td>
        </tr>
      </table>
      </li>

      <li>Click <strong>Install</strong> and then <strong>Yes</strong> to continue.</li>

      <li>The installer will provide feedback on the files it is
      downloading. The latest list of installation files is available
      from <a href="files.txt">files.txt</a></li>

      <li>When the installation is finished, click <strong>Done</strong>. If you're running the installer as a non-administrator user, you'll see an error message "Installation failed". This is OK, just close the error pop-up and click <strong>Done</strong>.</li>

      <li>To launch the EMF client, navigate to the Client Home Directory you selected during the installation process (e.g. C:\Program Files\EMF Client or C:\Users\username\EMF Client). Double-click the batch file named EMFClient.</li>
      </ol>
      
      <h3>Updating the EMF client</h3>
      <p>When an update of the EMF client is available, you'll be notified when you start the EMF client. For a list of recent EMF updates, visit the <a href="docs/Enhancements.html">EMF deployment updates</a> page.</p>
      <ol>
      <li>To download the update, navigate to the extraction folder you selected in Step 4 (e.g. C:\Program Files\EMF Client Installer). If you installed the EMF client as an Administrator, right-click the batch file named runinstaller and select "Run as administrator". Otherwise, double-click runinstaller.bat to launch the EMF Client Installer.</li>

      <li>Click <strong>Install</strong> and then <strong>Yes</strong> to continue.</li>

      <li>You will be prompted
			about whether you want to Update or Reinstall. Update will download
			only changed files, and Reinstall will download all files. Select Update and click <strong>OK</strong>.</li>

			<li>After checking for updates, you'll see a list of files that will be updated or deleted. Click <strong>Update</strong> to download the changes. If no updates are available, the Update button won't be enabled.</li>
      </ol>
    </div>
    <div id="footer">
      <p><a title="back to top" href="#border">back to top</a></p>
    </div>
  </div>
</div>

</body>
</html>
